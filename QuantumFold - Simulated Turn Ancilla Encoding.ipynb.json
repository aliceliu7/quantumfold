{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "from joblib import Parallel, delayed\n",
    "from sympy import *\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "from datetime import datetime as dt\n",
    "import matplotlib.pyplot as plt\n",
    "from matplotlib import animation\n",
    "import base64\n",
    "from IPython.display import HTML"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "#         Cys-C, Met-M, Phe-F, Ile-I, Leu-L, Val-V, Trp-W, Tyr-Y, Ala-A, Gly-G, Thr-T, Ser-S, Asn-N, Gln-Q, Asp-D, Glu-E, His-H, Arg-R, Lys-K, Pro-P\n",
    "imat = [[ -5.44, -4.99, -5.80, -5.50, -5.83, -4.96, -4.95, -4.16, -3.57, -3.16, -3.11, -2.86, -2.59, -2.85, -2.41, -2.27, -3.60, -2.57, -1.95, -3.07], # Cys-C\n",
    "        [ -4.99, -5.46, -6.56, -6.02, -6.41, -5.32, -5.55, -4.91, -3.94, -3.39, -3.51, -3.03, -2.95, -3.30, -2.57, -2.89, -3.98, -3.12, -2.48, -3.45], # Met-M\n",
    "        [ -5.80, -6.56, -7.26, -6.84, -7.28, -6.29, -6.16, -5.66, -4.81, -4.13, -4.28, -4.02, -3.75, -4.10, -3.48, -3.56, -4.77, -3.98, -3.36, -4.25], # Phe-F\n",
    "        [ -5.50, -6.02, -6.84, -6.54, -7.04, -6.05, -5.78, -5.25, -4.58, -3.78, -4.03, -3.52, -3.24, -3.67, -3.17, -3.27, -4.14, -3.63, -3.01, -3.76], # Ile-I\n",
    "        [ -5.83, -6.41, -7.28, -7.04, -7.37, -6.48, -6.14, -5.67, -4.91, -4.16, -4.34, -3.92, -3.74, -4.04, -3.40, -3.59, -4.54, -4.03, -3.37, -4.20], # Leu-L\n",
    "        [ -4.96, -5.32, -6.29, -6.05, -6.48, -5.52, -5.18, -4.62, -4.04, -3.38, -3.46, -3.05, -2.83, -3.07, -2.48, -2.67, -3.58, -3.07, -2.49, -3.32], # Val-V\n",
    "        [ -4.95, -5.55, -6.16, -5.78, -6.14, -5.18, -5.06, -4.66, -3.82, -3.42, -3.22, -2.99, -3.07, -3.11, -2.84, -2.99, -3.98, -3.41, -2.69, -3.73], # Trp-W\n",
    "        [ -4.16, -4.91, -5.66, -5.25, -5.67, -4.62, -4.66, -4.17, -3.36, -3.01, -3.01, -2.78, -2.76, -2.97, -2.76, -2.79, -3.52, -3.16, -2.60, -3.19], # Tyr-Y\n",
    "        [ -3.57, -3.94, -4.81, -4.58, -4.91, -4.04, -3.82, -3.36, -2.72, -2.31, -2.32, -2.01, -1.84, -1.89, -1.70, -1.51, -2.41, -1.83, -1.31, -2.03], # Ala-A\n",
    "        [ -3.16, -3.39, -4.13, -3.78, -4.16, -3.38, -3.42, -3.01, -2.31, -2.24, -2.08, -1.82, -1.74, -1.66, -1.59, -1.22, -2.15, -1.72, -1.15, -1.87], # Gly-G\n",
    "        [ -3.11, -3.51, -4.28, -4.03, -4.34, -3.46, -3.22, -3.01, -2.32, -2.08, -2.12, -1.96, -1.88, -1.90, -1.80, -1.74, -2.42, -1.90, -1.31, -1.90], # Thr-T\n",
    "        [ -2.86, -3.03, -4.02, -3.52, -3.92, -3.05, -2.99, -2.78, -2.01, -1.82, -1.96, -1.67, -1.58, -1.49, -1.63, -1.48, -2.11, -1.62, -1.05, -1.57], # Ser-S\n",
    "        [ -2.59, -2.95, -3.75, -3.24, -3.74, -2.83, -3.07, -2.76, -1.84, -1.74, -1.88, -1.58, -1.68, -1.71, -1.68, -1.51, -2.08, -1.64, -1.21, -1.53], # Asn-N\n",
    "        [ -2.85, -3.30, -4.10, -3.67, -4.04, -3.07, -3.11, -2.97, -1.89, -1.66, -1.90, -1.49, -1.71, -1.54, -1.46, -1.42, -1.98, -1.80, -1.29, -1.73], # Gln-Q\n",
    "        [ -2.41, -2.57, -3.48, -3.17, -3.40, -2.48, -2.84, -2.76, -1.70, -1.59, -1.80, -1.63, -1.68, -1.46, -1.21, -1.02, -2.32, -2.29, -1.68, -1.33], # Asp-D\n",
    "        [ -2.27, -2.89, -3.56, -3.27, -3.59, -2.67, -2.99, -2.79, -1.51, -1.22, -1.74, -1.48, -1.51, -1.42, -1.02, -0.91, -2.15, -2.27, -1.80, -1.26], # Glu-E\n",
    "        [ -3.60, -3.98, -4.77, -4.14, -4.54, -3.58, -3.98, -3.52, -2.41, -2.15, -2.42, -2.11, -2.08, -1.98, -2.32, -2.15, -3.05, -2.16, -1.35, -2.25], # His-H\n",
    "        [ -2.57, -3.12, -3.98, -3.63, -4.03, -3.07, -3.41, -3.16, -1.83, -1.72, -1.90, -1.62, -1.64, -1.80, -2.29, -2.27, -2.16, -1.55, -0.59, -1.70], # Arg-R\n",
    "        [ -1.95, -2.48, -3.36, -3.01, -3.37, -2.49, -2.69, -2.60, -1.31, -1.15, -1.31, -1.05, -1.21, -1.29, -1.68, -1.80, -1.35, -0.59, -0.12, -0.97], # Lys-K\n",
    "        [ -3.07, -3.45, -4.25, -3.76, -4.20, -3.32, -3.73, -3.19, -2.03, -1.87, -1.90, -1.57, -1.53, -1.73, -1.33, -1.26, -2.25, -1.70, -0.97, -1.75]] # Pro-P\n",
    "imat = np.array(imat)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "# the list of aminoacid 1 letter codes\n",
    "names = ['C','M','F','I','L','V','W','Y','A','G','T','S','N','Q','D','E','H','R','K','P']\n",
    "\n",
    "# Dictionary for translating 1 letter code to numeric index for MJ interaction matrix\n",
    "d = {names[i]:i for i in range(len(names))}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_combinations(pos):\n",
    "    # This variable holds a list of all possible unique combinations of \n",
    "    # aminoacid in the chain. This is for interaction energy computations\n",
    "    \n",
    "    n = len(pos)\n",
    "    comb = np.array(np.meshgrid(range(n), range(n))).T.reshape((-1,2))\n",
    "    comb = comb[comb[:,1]-comb[:,0]>0]\n",
    "\n",
    "    return comb"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "def total_energy(pos, seq, comb=None):\n",
    "    '''Computes the total energy of the system.\n",
    "    \n",
    "    pos: numpy array with shape (n, 2)\n",
    "    '''\n",
    "    \n",
    "    if type(seq) == str:\n",
    "        seq = [d[a] for a in seq]\n",
    "\n",
    "    s = seq\n",
    "    \n",
    "    if comb is None:\n",
    "        comb = get_combinations(pos)\n",
    "\n",
    "    tot = 0\n",
    "    for c in comb:\n",
    "        dl1 = np.abs(pos[c[1]] - pos[c[0]]).sum()\n",
    "        if dl1 == 0:\n",
    "            # Overlap\n",
    "            tot += 1000\n",
    "        elif dl1 == 1 and c[1] - c[0] > 2:\n",
    "            # Contact\n",
    "            tot += imat[s[c[0]], s[c[1]]]\n",
    "\n",
    "    return tot\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "# These are the possible directions to choose in random walk\n",
    "# Only consider moving from the current position\n",
    "dirs = {\n",
    "    (  1,  0): np.array([(  0,  1),\n",
    "                         ( -1,  0),\n",
    "                         (  0, -1)]),\n",
    "    (  0,  1): np.array([(  1,  0),\n",
    "                         ( -1,  0),\n",
    "                         (  0, -1)]),\n",
    "    ( -1,  0): np.array([(  1,  0),\n",
    "                         (  0,  1),\n",
    "                         (  0, -1)]),\n",
    "    (  0, -1): np.array([(  1,  0),\n",
    "                         (  0,  1),\n",
    "                         ( -1,  0)]),\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "def simulate_trajectory(prot_seq, sched, jobid=0):\n",
    "\n",
    "    Nit = len(sched)\n",
    "    \n",
    "    seed = dt.now().microsecond * (jobid + 1)\n",
    "    \n",
    "    # Working in parallel, better reseed\n",
    "    np.random.seed(seed)\n",
    "    \n",
    "    # The sequence translated to index\n",
    "    s = [d[a] for a in prot_seq]\n",
    "\n",
    "    # length of the sequence\n",
    "    N = len(s)\n",
    "    \n",
    "    pos = np.zeros((N, 2))\n",
    "    pos[:,0] = range(N)\n",
    "    \n",
    "    tra = np.empty((Nit, N, 2))\n",
    "    \n",
    "    comb = get_combinations(pos)\n",
    "    \n",
    "    # Random numbers for selecting residue\n",
    "    I = np.random.randint(2, N, size=Nit)\n",
    "    \n",
    "    # Random numbers for selecting walking direction\n",
    "    J = np.random.randint(3, size=Nit)\n",
    "    \n",
    "    # Third aminoacid walks only up or right. This is to avoid redundant conformations\n",
    "    J[I == 2] = 0\n",
    "    \n",
    "    # Throw a dice for proposal acceptance/rejection\n",
    "    K = np.random.uniform(size=Nit)\n",
    "    \n",
    "    # History of accepted conformations\n",
    "    H = np.empty((Nit,))\n",
    "    \n",
    "    # Energy trace\n",
    "    E = np.empty((Nit,))\n",
    "\n",
    "    # measure current energy\n",
    "    E0 = total_energy(pos, s, comb)\n",
    "    \n",
    "    # main loop\n",
    "    for it, (i, j, dice, T) in enumerate(zip(I, J, K, sched)):\n",
    "\n",
    "        # store current position\n",
    "        # we will need to restore it if walk is not successful\n",
    "        curr = pos[i:].copy()\n",
    "\n",
    "        # one step is to be taken using previous aminoacid as reference\n",
    "        back = tuple(pos[i] - pos[i-1])\n",
    "\n",
    "        # random walk\n",
    "        wdir = dirs[back][j] - back\n",
    "        \n",
    "        pos[i:] += wdir\n",
    "\n",
    "        # new energy of the system\n",
    "        E1 = total_energy(pos, s, comb)\n",
    "\n",
    "        # Delta E: change of energy will determine the probability\n",
    "        # of accepting this step\n",
    "        dE = E1 - E0\n",
    "        \n",
    "        # Simulated Annealing\n",
    "        prob = np.exp(-dE/T)\n",
    "        accept = prob > dice\n",
    "\n",
    "        if not accept:\n",
    "            pos[i:] = curr\n",
    "            H[it] = 0\n",
    "        else:\n",
    "            E0 = E1\n",
    "            H[it] = 1\n",
    "\n",
    "        E[it] = E0\n",
    "        tra[it] = pos\n",
    "\n",
    "    return tra, H, E, seed, pos"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "def make_viz(pos, prot_seq, info=None, movie=False, schedule=[], energy_func=[]):\n",
    "    if movie:\n",
    "        return make_movie(pos, schedule, prot_seq, energy_func)\n",
    "    \n",
    "    if (len(pos.shape) == 3 and pos.shape[2] == 2):\n",
    "        pos = pos[-1]\n",
    "\n",
    "    qbit_model = False\n",
    "    if pos.shape[1] != 2:\n",
    "        qbit_model = True\n",
    "        q = pos[-1]\n",
    "        def dw(j):\n",
    "            return (1 - q[2*j])*(1 - q[2*j + 1])\n",
    "\n",
    "        def rg(j):\n",
    "            return (1 - q[2*j])*q[2*j + 1]\n",
    "\n",
    "        def lf(j):\n",
    "            return q[2*j]*(1 - q[2*j + 1])\n",
    "\n",
    "        def up(j):\n",
    "            return q[2*j]*q[2*j + 1]\n",
    "\n",
    "        def x(j):\n",
    "            return sum([(rg(k) - lf(k)) for k in range(j)])\n",
    "\n",
    "        def y(j):\n",
    "            return sum([(up(k) - dw(k)) for k in range(j)])\n",
    "\n",
    "        pos = np.array([(x(j), y(j)) for j in range(len(prot_seq))])\n",
    "        \n",
    "    n = pos.shape[0]\n",
    "    fig = plt.figure(figsize=(10,10))\n",
    "    ax = fig.add_subplot(111, aspect=1)\n",
    "    # Major ticks every 20, minor ticks every 5\n",
    "    major_ticks = np.arange(-n, n, 10)\n",
    "    minor_ticks = np.arange(-n, n, 1)\n",
    "    ax.set_xticks(major_ticks)\n",
    "    ax.set_xticks(minor_ticks, minor=True)\n",
    "    ax.set_yticks(major_ticks)\n",
    "    ax.set_yticks(minor_ticks, minor=True)\n",
    "    ax.grid(which='both')\n",
    "    ax.grid(which='minor', alpha=0.2)\n",
    "    ax.grid(which='major', alpha=0.5)\n",
    "\n",
    "    ax.plot(*pos.T, '-bo', linewidth=5, markersize=20, alpha=0.7)\n",
    "    ax.set_xlim([-n,n])\n",
    "    ax.set_ylim([-n,n])\n",
    "\n",
    "    if info is not None:\n",
    "        ax.text(-n+1, n-1, f\"{info}\", fontsize=15)\n",
    "    \n",
    "    if prot_seq:\n",
    "        for i, (x, y) in enumerate(pos):\n",
    "            ax.text(x, y, prot_seq[i], color='white', verticalalignment='center', horizontalalignment='center', fontweight='bold')\n",
    "\n",
    "    info = ''\n",
    "    if len(schedule) > 0:\n",
    "        info = f'{info}Temperature = {schedule[-1]:.6f}'\n",
    "    if prot_seq:\n",
    "        if qbit_model:\n",
    "            system_ene = energy_func(*q)\n",
    "        else:\n",
    "            system_ene = total_energy(pos, prot_seq)\n",
    "        info = f'{info}\\nEnergy = {system_ene:.2f}'\n",
    "    ax.text(-n+1, n-1, info, fontsize=15)\n",
    "        "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "def make_movie(traj, schedule, prot_seq, energy_func=[]):\n",
    "\n",
    "    qbit_model = False\n",
    "    if len(traj.shape) == 2:\n",
    "        qbit_model = True\n",
    "        \n",
    "        N, n, di = (len(schedule), len(prot_seq), 2)\n",
    "        \n",
    "        trajectory = np.zeros((N, n, di))\n",
    "        q = np.zeros((N, traj.shape[1]))\n",
    "        for i, qs in enumerate(traj):\n",
    "\n",
    "            def dw(j):\n",
    "                return (1 - qs[2*j])*(1 - qs[2*j + 1])\n",
    "\n",
    "            def rg(j):\n",
    "                return (1 - qs[2*j])*qs[2*j + 1]\n",
    "\n",
    "            def lf(j):\n",
    "                return qs[2*j]*(1 - qs[2*j + 1])\n",
    "\n",
    "            def up(j):\n",
    "                return qs[2*j]*qs[2*j + 1]\n",
    "\n",
    "            def x(j):\n",
    "                return sum([(rg(k) - lf(k)) for k in range(j)])\n",
    "\n",
    "            def y(j):\n",
    "                return sum([(up(k) - dw(k)) for k in range(j)])\n",
    "\n",
    "            trajectory[i] = np.array([(x(j), y(j)) for j in range(len(prot_seq))])\n",
    "            q[i] = qs\n",
    "    else:\n",
    "        N, n, di = traj.shape\n",
    "        trajectory = traj\n",
    "\n",
    "    fig = plt.figure(figsize=(10,10))\n",
    "    ax = fig.add_subplot(111, aspect=1)\n",
    "    # Major ticks every 20, minor ticks every 5\n",
    "    major_ticks = np.arange(-n, n, 10)\n",
    "    minor_ticks = np.arange(-n, n, 1)\n",
    "    ax.set_xticks(major_ticks)\n",
    "    ax.set_xticks(minor_ticks, minor=True)\n",
    "    ax.set_yticks(major_ticks)\n",
    "    ax.set_yticks(minor_ticks, minor=True)\n",
    "    ax.grid(which='both')\n",
    "    ax.grid(which='minor', alpha=0.2)\n",
    "    ax.grid(which='major', alpha=0.5)\n",
    "    ax.set_xlim([-n, n])\n",
    "    ax.set_ylim([-n, n])\n",
    "\n",
    "    conformation, = ax.plot([], [], '-bo', linewidth=5, markersize=20, alpha=0.7)\n",
    "    temperature = ax.text(-n+1, n-1, '', fontsize=15, verticalalignment='top')\n",
    "\n",
    "    seq_txt = [None] * len(prot_seq)\n",
    "    if prot_seq:\n",
    "        for i, (x, y) in enumerate(trajectory[1]):\n",
    "            seq_txt[i] = ax.text(x, y, prot_seq[i], color='white', verticalalignment='center', horizontalalignment='center', fontweight='bold')\n",
    "\n",
    "    def init():\n",
    "        conformation.set_data([], [])\n",
    "        temperature.set_text('')\n",
    "        return conformation,\n",
    "\n",
    "    def animate(i):\n",
    "        pos = trajectory[i]\n",
    "        conformation.set_data(*pos.T)\n",
    "        info = ''\n",
    "        if len(schedule) > 0:\n",
    "            info = f'{info}Temperature = {schedule[i]:.6f}'\n",
    "        if prot_seq:\n",
    "            if qbit_model:\n",
    "                system_ene = energy_func(*q[i])\n",
    "            else:\n",
    "                system_ene = total_energy(pos, prot_seq)\n",
    "            info = f'{info}\\nEnergy = {system_ene:.2f}'\n",
    "        temperature.set_text(info)\n",
    "        if prot_seq:\n",
    "            for i, (x, y) in enumerate(pos):\n",
    "                seq_txt[i].set_x(x)\n",
    "                seq_txt[i].set_y(y)\n",
    "        return conformation,\n",
    "\n",
    "    # call the animator.  blit=True means only re-draw the parts that have changed.\n",
    "    anim = animation.FuncAnimation(fig, animate, init_func=init,\n",
    "                                   frames=N, interval=20, blit=True)\n",
    "    anim.save('trajectory.mp4', fps=30, extra_args=['-vcodec', 'libx264'])\n",
    "    plt.show()\n",
    "    \n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "#QUANTUM ANNEALING:\n",
    "\n",
    "def u(i, j):\n",
    "    # eqn 22\n",
    "    # Helps to determine number of qbits for overlap\n",
    "    return np.int(((1 + j - i) % 2) * np.ceil(2*np.log2(j - i)))\n",
    "\n",
    "\n",
    "def prepare_quantum(prot_seq, return_Hs=False):\n",
    "\n",
    "    # length of the sequence\n",
    "    N = len(prot_seq)\n",
    "    \n",
    "    # The sequence translated to index\n",
    "    s = [d[a] for a in prot_seq]\n",
    "\n",
    "    # Determine number of qbits needed\n",
    "    # qbits for turns: first qbit position, number of qbits and qbits\n",
    "    ftq = 0\n",
    "    ntq = 2 * (N-1)\n",
    "    # ancilla qbits for overlap\n",
    "    foq = ftq + ntq\n",
    "    noq = sum([sum([u(i,j) for j in range(i+4, N+1)]) for i in range(N-4)])\n",
    "    # ancilla qbits for pairwise interactions\n",
    "    fiq = foq + noq\n",
    "    niq = int((N-3)*(N-2)/2)\n",
    "\n",
    "    Nqbits = ntq + noq + niq\n",
    "    \n",
    "    # Symbolic computation of Energy function\n",
    "\n",
    "    q = symbols([f'q{i:04d}' for i in range(Nqbits)])\n",
    "    q = np.array(q)\n",
    "\n",
    "    # 0 0 down\n",
    "    # 0 1 right\n",
    "    # 1 0 left\n",
    "    # 1 1 up\n",
    "\n",
    "    def dw(j):\n",
    "        nonlocal q\n",
    "        return (1 - q[2*j])*(1 - q[2*j + 1])\n",
    "\n",
    "    def rg(j):\n",
    "        nonlocal q\n",
    "        return (1 - q[2*j])*q[2*j + 1]\n",
    "\n",
    "    def lf(j):\n",
    "        nonlocal q\n",
    "        return q[2*j]*(1 - q[2*j + 1])\n",
    "\n",
    "    def up(j):\n",
    "        nonlocal q\n",
    "        return q[2*j]*q[2*j + 1]\n",
    "\n",
    "    def back(j):\n",
    "        nonlocal q\n",
    "        return rg(j)*lf(j+1) + lf(j)*rg(j+1) + up(j)*dw(j+1) + dw(j)*up(j+1)\n",
    "\n",
    "    def x(j):\n",
    "        return sum([(rg(k) - lf(k)) for k in range(j)])\n",
    "\n",
    "    def y(j):\n",
    "        return sum([(up(k) - dw(k)) for k in range(j)])\n",
    "\n",
    "    def g(i, j):\n",
    "        # eqn 16\n",
    "        return (x(i) - x(j))**2 + (y(i) - y(j))**2\n",
    "\n",
    "    def c(i, j):\n",
    "        # eqn 25\n",
    "        return sum([sum([u(m, n) for n in range(m+4, N+1)]) for m in range(i+1)]) - sum([u(i, n) for n in range(j, N+1)]) + foq\n",
    "\n",
    "    def alpha(i,j):\n",
    "        uij = u(i,j)\n",
    "        cij = c(i,j)\n",
    "        return sum([q[cij+k]*2**k for k in range(uij)])\n",
    "\n",
    "    def w(i,j):\n",
    "        nonlocal q\n",
    "        return q[i*((N-3)-i+1) + int((i-1)*i/2) - (i - j) - 3 + fiq]\n",
    "\n",
    "    def J(i, j):\n",
    "        if (j-i) % 2:\n",
    "            return imat[s[i], s[j]]\n",
    "        else:\n",
    "            # only odd pairs can be in contact\n",
    "            return 0\n",
    "\n",
    "    def H_back():\n",
    "        l_back = 10\n",
    "        return sum([back(j) for j in range(N-2)]) * l_back\n",
    "\n",
    "    def H_olap():\n",
    "        # Idea, l_olap needs to big large enough so that its penalization compensates the favoring term in H_inte\n",
    "        # so it would be good it we customize each l_olap according to each Jij\n",
    "        l_olap = 10\n",
    "        return sum([sum([l_olap*((1+i-j)%2)*(2**u(i,j) - g(i,j) - alpha(i, j))**2 for j in range(i+4, N)]) for i in range(N-4)])\n",
    "\n",
    "    def H_inte():\n",
    "        # eqn 32\n",
    "        return sum([sum([w(i,j)*J(i,j)*(2-g(i,j)) for j in range(i+3, N)]) for i in range(N-3)])\n",
    "\n",
    "    # Build energy terms (symbolic expressions)\n",
    "    Hb = (H_back())\n",
    "    Ho = (H_olap()) if noq > 0 else 0\n",
    "    Hi = (H_inte())\n",
    "    \n",
    "    energy_expr = Hb + Ho + Hi\n",
    "\n",
    "    if return_Hs:\n",
    "        return prot_seq, q, energy_expr, (Hb, Ho, Hi)\n",
    "    else:\n",
    "        return prot_seq, q, energy_expr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "def simulate_quantum(prot_seq, q_sym, energy_expr, sched, jobid=0):\n",
    "\n",
    "    # Callable function to compute energy\n",
    "    energy = lambdify(q_sym, energy_expr)\n",
    "\n",
    "    # length of the sequence\n",
    "    N = len(prot_seq)\n",
    "\n",
    "    # Determine number of qbits needed\n",
    "    # qbits for turns: first qbit position, number of qbits and qbits\n",
    "    ftq = 0\n",
    "    ntq = 2 * (N-1)\n",
    "    # ancilla qbits for overlap\n",
    "    foq = ftq + ntq\n",
    "    noq = sum([sum([u(i,j) for j in range(i+4, N+1)]) for i in range(N-4)])\n",
    "    # ancilla qbits for pairwise interactions\n",
    "    fiq = foq + noq\n",
    "    niq = int((N-3)*(N-2)/2)\n",
    "    \n",
    "    Nqbits = ntq + noq + niq\n",
    "    \n",
    "    assert Nqbits == len(q_sym), \"Error!!!\"\n",
    "\n",
    "    Nit = len(sched)\n",
    "    \n",
    "    seed = dt.now().microsecond * (jobid + 1)\n",
    "    \n",
    "    # Working in parallel, better reseed\n",
    "    np.random.seed(seed)\n",
    "\n",
    "    # initialize qbits vector\n",
    "    q = [0 for i in range(Nqbits)]\n",
    "    q = np.array(q)\n",
    "\n",
    "    # Set initial positions\n",
    "    q[ftq:ftq+ntq] = [0, 1] * (N-1)\n",
    "    q[foq:foq+noq] = 1\n",
    "    q[fiq:fiq+niq] = 0\n",
    "\n",
    "    def dw(j):\n",
    "        nonlocal q\n",
    "        return (1 - q[2*j])*(1 - q[2*j + 1])\n",
    "\n",
    "    def rg(j):\n",
    "        nonlocal q\n",
    "        return (1 - q[2*j])*q[2*j + 1]\n",
    "\n",
    "    def lf(j):\n",
    "        nonlocal q\n",
    "        return q[2*j]*(1 - q[2*j + 1])\n",
    "\n",
    "    def up(j):\n",
    "        nonlocal q\n",
    "        return q[2*j]*q[2*j + 1]\n",
    "\n",
    "    def x(j):\n",
    "        nonlocal q\n",
    "        return sum([(rg(k) - lf(k)) for k in range(j)])\n",
    "\n",
    "    def y(j):\n",
    "        nonlocal q\n",
    "        return sum([(up(k) - dw(k)) for k in range(j)])\n",
    "    \n",
    "    def pos():\n",
    "        # translates q vector to position coordinates\n",
    "        # useful for visualization\n",
    "        return np.array([(x(j), y(j)) for j in range(len(prot_seq))])\n",
    "\n",
    "    tra = np.empty((Nit, Nqbits))\n",
    "\n",
    "    # Random numbers for selecting qbit\n",
    "    Q = np.random.randint(3, len(q), size=Nit)\n",
    "\n",
    "    # Throw a dice for proposal acceptance/rejection\n",
    "    K = np.random.uniform(size=Nit)\n",
    "\n",
    "    # History of accepted conformations\n",
    "    H = np.empty((Nit,))\n",
    "    \n",
    "    # Energy trace\n",
    "    E = np.empty((Nit,))\n",
    "\n",
    "    # measure current energy\n",
    "    E0 = energy(*q)\n",
    "\n",
    "    # main loop\n",
    "    for it, (i, dice, T) in enumerate(zip(Q, K, sched)):\n",
    "#     for it, (dice, T) in enumerate(zip(K, sched)):\n",
    "#         i = (it % (Nqbits-3)) + 3\n",
    "\n",
    "        # flip selected qbit\n",
    "        q[i] = 0 if q[i] else 1\n",
    "\n",
    "        # new energy of the system\n",
    "        E1 = energy(*q)\n",
    "\n",
    "        # Delta E: change of energy will determine the probability\n",
    "        # of accepting this step\n",
    "        dE = E1 - E0\n",
    "\n",
    "        # Simulated Annealing\n",
    "        prob = np.exp(-dE/T)\n",
    "        accept = prob > dice\n",
    "\n",
    "        if not accept:\n",
    "            # flip back\n",
    "            q[i] = 0 if q[i] else 1\n",
    "            H[it] = 0\n",
    "        else:\n",
    "            E0 = E1\n",
    "            H[it] = 1\n",
    "\n",
    "        E[it] = E0\n",
    "        tra[it] = q\n",
    "\n",
    "    return tra, H, E, seed, q"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "def show_video():\n",
    "    video = open('trajectory.mp4', 'rb').read()\n",
    "    encoded = base64.b64encode(video)\n",
    "    return HTML(data='''<video alt=\"test\" controls>\n",
    "                           <source src=\"data:video/mp4;base64,{0}\" type=\"video/mp4\" />\n",
    "                        </video>'''.format(encoded.decode('ascii')))\n",
    "\n",
    "\n",
    "def viz_short_smpl(smpl, prot_seq, q, energy_func):\n",
    "    qstr_short = [smpl[k] if k in smpl.keys() else 0 for k in q[3:]]\n",
    "    qstr = np.array([[0, 1, 0] + qstr_short])\n",
    "    make_viz(qstr, prot_seq, movie=False, energy_func=energy_func)\n",
    "\n",
    "\n",
    "def preprocess_expr(H, q):\n",
    "    # Helper function to clean resulting expressions\n",
    "    # some zero coefficients fail to evaluate to 0, rounding is necessary\n",
    "    # for all qbits, qi**n = qi. bc qi in [0,1]\n",
    "    \n",
    "    H = expand(H).evalf()\n",
    "    tmp = H\n",
    "    for a in preorder_traversal(tmp):\n",
    "        if isinstance(a, Float):\n",
    "            H = H.subs(a, round(a, 8))\n",
    "    degr = Poly(H).degree()\n",
    "    for qi in q:\n",
    "        for n in reversed(range(2, degr + 1)):\n",
    "            H = H.subs(qi**n, qi)\n",
    "    return H"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "#SIMULATED TURN ANCILLA ENCODING"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "# The sequence of protein to fold\n",
    "# prot_seq = \"YYDPETGTWY\"\n",
    "prot_seq = \"YYDPET\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "prot_seq, q, energy_expr = prepare_quantum(prot_seq)\n",
    "energy_func = lambdify(q, energy_expr)\n",
    "sched = np.power(2, np.linspace(4, -1, 300))\n",
    "max(sched), min(sched), len(sched)\n",
    "plt.plot(sched)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(np.exp(-10/sched))\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "num_cores = 12\n",
    "\n",
    "res = Parallel(n_jobs=num_cores)(delayed(simulate_quantum)(prot_seq, q, energy_expr, sched, jobid) for jobid in range(720))\n",
    "tra, H, E, seeds, results = zip(*res)\n",
    "tra = np.array(tra)\n",
    "history = np.array(H)\n",
    "energy = np.array(E)\n",
    "acp = history.cumsum(axis=1)\n",
    "plt.plot(acp.mean(axis=0))\n",
    "plt.fill_between(\n",
    "    range(acp.shape[1]),\n",
    "    acp.mean(axis=0) - acp.std(axis=0),\n",
    "    acp.mean(axis=0) + acp.std(axis=0), alpha=0.2)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "MovieWriter ffmpeg unavailable; trying to use <class 'matplotlib.animation.PillowWriter'> instead.\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "unknown file extension: .mp4",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "\u001b[0;32m/opt/anaconda3/lib/python3.7/site-packages/PIL/Image.py\u001b[0m in \u001b[0;36msave\u001b[0;34m(self, fp, format, **params)\u001b[0m\n\u001b[1;32m   2063\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2064\u001b[0;31m                 \u001b[0mformat\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mEXTENSION\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mext\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2065\u001b[0m             \u001b[0;32mexcept\u001b[0m \u001b[0mKeyError\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mKeyError\u001b[0m: '.mp4'",
      "\nDuring handling of the above exception, another exception occurred:\n",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-27-780976c6b4f3>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0mbest\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0margmin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0menes\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 4\u001b[0;31m \u001b[0mmake_viz\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtra\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mbest\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mprot_seq\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mschedule\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0msched\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmovie\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0menergy_func\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0menergy_func\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      5\u001b[0m \u001b[0mall_best\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marray\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0menes\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0mmin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0menes\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mall_best\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msum\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m<ipython-input-16-f45ce324af30>\u001b[0m in \u001b[0;36mmake_viz\u001b[0;34m(pos, prot_seq, info, movie, schedule, energy_func)\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;32mdef\u001b[0m \u001b[0mmake_viz\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpos\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mprot_seq\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minfo\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmovie\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mFalse\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mschedule\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0menergy_func\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mmovie\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mmake_movie\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpos\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mschedule\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mprot_seq\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0menergy_func\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      4\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;36m3\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mpos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;36m2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m<ipython-input-17-50fe448dded0>\u001b[0m in \u001b[0;36mmake_movie\u001b[0;34m(traj, schedule, prot_seq, energy_func)\u001b[0m\n\u001b[1;32m     85\u001b[0m     anim = animation.FuncAnimation(fig, animate, init_func=init,\n\u001b[1;32m     86\u001b[0m                                    frames=N, interval=20, blit=True)\n\u001b[0;32m---> 87\u001b[0;31m     \u001b[0manim\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msave\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'trajectory.mp4'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfps\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m30\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mextra_args\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'-vcodec'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'libx264'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     88\u001b[0m     \u001b[0mplt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshow\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     89\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/opt/anaconda3/lib/python3.7/site-packages/matplotlib/animation.py\u001b[0m in \u001b[0;36msave\u001b[0;34m(self, filename, writer, fps, dpi, codec, bitrate, extra_args, metadata, extra_anim, savefig_kwargs, progress_callback)\u001b[0m\n\u001b[1;32m   1154\u001b[0m                             \u001b[0mprogress_callback\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mframe_number\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtotal_frames\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1155\u001b[0m                             \u001b[0mframe_number\u001b[0m \u001b[0;34m+=\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1156\u001b[0;31m                     \u001b[0mwriter\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgrab_frame\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0msavefig_kwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1157\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1158\u001b[0m         \u001b[0;31m# Reconnect signal for first draw if necessary\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/opt/anaconda3/lib/python3.7/contextlib.py\u001b[0m in \u001b[0;36m__exit__\u001b[0;34m(self, type, value, traceback)\u001b[0m\n\u001b[1;32m    117\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mtype\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    118\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 119\u001b[0;31m                 \u001b[0mnext\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgen\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    120\u001b[0m             \u001b[0;32mexcept\u001b[0m \u001b[0mStopIteration\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    121\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/opt/anaconda3/lib/python3.7/site-packages/matplotlib/animation.py\u001b[0m in \u001b[0;36msaving\u001b[0;34m(self, fig, outfile, dpi, *args, **kwargs)\u001b[0m\n\u001b[1;32m    230\u001b[0m             \u001b[0;32myield\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    231\u001b[0m         \u001b[0;32mfinally\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 232\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfinish\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    233\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    234\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/opt/anaconda3/lib/python3.7/site-packages/matplotlib/animation.py\u001b[0m in \u001b[0;36mfinish\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    575\u001b[0m         self._frames[0].save(\n\u001b[1;32m    576\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_outfile\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msave_all\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mappend_images\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_frames\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 577\u001b[0;31m             duration=int(1000 / self.fps), loop=0)\n\u001b[0m\u001b[1;32m    578\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    579\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/opt/anaconda3/lib/python3.7/site-packages/PIL/Image.py\u001b[0m in \u001b[0;36msave\u001b[0;34m(self, fp, format, **params)\u001b[0m\n\u001b[1;32m   2064\u001b[0m                 \u001b[0mformat\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mEXTENSION\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mext\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2065\u001b[0m             \u001b[0;32mexcept\u001b[0m \u001b[0mKeyError\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2066\u001b[0;31m                 \u001b[0;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"unknown file extension: {}\"\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mformat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mext\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2067\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2068\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mformat\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mupper\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mSAVE\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mValueError\u001b[0m: unknown file extension: .mp4"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAkMAAAI/CAYAAAB02d0hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nO3deXwUZYLG8aeSTNI2dDgUCIIhHCp4xAMFlEMxXhxx1R3GCwQXj0VHnREPWBVQZwV0dJ11HXcUBbwF1NWIKJcoIiBx2EFnYQCHjAcGhrtNCEwn7/5RpqXTSUhIp5rK+/t+PvmErn6r6kklM/VYVV3lGGMEAABgq5RkBwAAAEgmyhAAALAaZQgAAFiNMgQAAKxGGQIAAFajDAEAAKulJWOlrVu3Nl26dEnGqg9ZRUWFUlL81x39mJvM3vBjZsmfucnsHT/m3r9/v9LT05Mdo178uJ0l6fPPP99mjGlTdXpSylDHjh1VWFiYjFUfsnA4rFAolOwY9ebH3GT2hh8zS/7MTWbv+DF3UVGRcnJykh2jXvy4nSXJcZy/VTfdf7UOAAAggShDAADAapQhAABgNcoQAACwGmUIAABYjTIEAACsRhkCAABWowwBAACrUYYAAIDVKEMAAMBqlCEAAGA1yhAAALAaZQgAAFiNMgQAAKxGGQIAAFajDAEAAKtRhgAAgNUoQwAAwGqUIQAAYDXKEAAAsBplCAAAWI0yBAAArEYZAgAAVqMMAQAAq1GGAACA1ShDAADAapQhAABgNcoQAACwGmUIAABYjTIEAACsRhkCAABWowwBAACrUYYAAIDVKEMAAMBqlCEAAGA1yhAAALAaZQgAAFiNMgQAAKxGGQIAAFajDAEAAKtRhgAAgNUoQwAAwGqUIQAAYDXKEAAAsFqalytzHCdfUn52drbC4bCXq26wzMzMg46ZO3eu+vfv70GauispKWmU5X7//feaPn26Ro4cqQ4dOiR02Y2VuS4qKio0depUzZgxQ7t27dIZZ5yhRx99VCeccEKt840YMUJvv/123PQvvvhCnTp1ir7esWOH7rnnHr3//vuSpMGDB2vKlClq1apVzHxvvfWWJk+erE2bNqlLly669957dckll8SMaeiyDtzOdV3W4SCZfx+Hisze8WPusrIy3+0T/bida2WM8fzr5JNPNn6zcOFCs3z5crN8+XKzePFiI8ncd9990WnLly83u3fvTnbMOHv27GmU5a5atcpIMsuXL0/4shsrc11MmDDBBINB8/TTT5v58+eb888/37Rr185s27at1vkuv/xyk5ubG/P3sHz5clNWVhYz7pxzzjHdunUzb775ppkzZ47p3LmzycvLixmzcOFCk5KSYsaOHWsWL15sbrvtNpOSkmKWLFmS0GUduJ3rsqzDRTL/Pg4Vmb3jx9ybNm1KdoR68+N2NsYYSYWmml5CGaqjA3/x4XDYSDLTp09PXqA6qs8fbCQSMfv376/T2ESXoX379pny8nJjTPL+RxYOh00wGDRTp06NTtu9e7dp2bKleeihh2qd9/LLLzd9+/atdUxliV65cmV02kcffWQkmaVLl0anDRgwwAwaNChm3oEDB8aUk0Qsq3I713VZhws//p8wmb3jx9yUIe/UVIa4ZqgRbNq0ScOGDVPLli3VrFkzDRkyRF999VX0/XXr1slxHL3xxhsaPny4QqGQsrOz9frrr0uS/v3f/13t27dX27Ztdf/997ut9Ufjxo1Tx44dtWTJEp166qkKBALq2bOnVqxYEZfj6aef1hlnnKGMjAx17txZTzzxRMz7V155pfr166dZs2apR48eysjI0P/+7//qm2++0ciRI9W5c2cdccQROv744/XAAw/oH//4RzT/mWeeKUk666yz5DiOAoGAJOm///u/5TiOIpFIzLqysrJ03333RV/36dNHw4cP13/9139F17N9+3ZJ0po1a3TxxRcrFAqpRYsWuuqqq/T3v//9kH8fdfXxxx+rtLRUv/jFL6LTMjMzNWjQIM2bN6/By583b546deqkXr16RacNGDBA7du3jy4/HA7rk08+ickgub+rjz76SKWlpUlZFgA0ZZShBNu6dav69u2roqIiTZs2Ta+++qq2bdumCy+8UPv3748ZO3bsWHXt2lVvvvmmzjzzTA0fPlx33HGHvvzyS82YMUM333yzfvOb38Rdi7Jnzx5dd911uvXWWzV79mwFAgFdfPHF0TIhSQ899JB+9atf6bLLLtPcuXM1evRo3X333Zo2bVrMstavX68JEybo/vvv13vvvadjjjlGW7duVVZWlp544gm9//77+vWvf62nn35ad955pyQpJydH06dPlyRNmzZNy5cv18cff1zvbbVo0SK98MILeuyxx/T2228rGAxq7dq1uvjiiyVJL7/8sqZNm6bPP/9cl112Wa3LMsYoEokc9Ks269atUyAQUE5OTsz0Hj16aN26dQf9eVavXq1QKKRAIKABAwZo2bJlccvv3r173HwHLn/Dhg2qqKiIG9ejRw9FIpFoqU7EsjZt2lTnZQFAU+bpBdQ2ePTRR1VRUaGFCxeqRYsWktyjJ507d9aLL76o0aNHR8cOGjRIDzzwgCTp9NNP11tvvaX58+friy++kOM4uuiii/Tmm2/qrbfe0qWXXhqdLxwOa8aMGbr88sslSf3799cxxxyjJ598UpMmTdKOHTv08MMP68EHH9TNN9+sUCik888/X3v27NGDDz6o66+/Prqsbdu26aOPPlKPHj2i07KystSzZ09Jbsno27ev0tPTdfvtt+vxxx9XIBDQSSedJEk68cQT1adPn0PaVuFwWPPmzdORRx4ZnTZhwgRlZ2fr3XffVVqa++d5wgkn6OSTT9aiRYuUl5dX7bI++OADDRo06KDr/P7775WVlVXtezt37oz+zg7UqlUr7dq1q9bl9uzZUxdeeKF69Oih4uJiPfLII8rLy9OKFSt06qmnRpdf3cXmrVq10o4dO6JjJKlly5ZxYw58PxHLqvyZ6rIsAGjKKEMJtnDhQl188cVq1qxZ9EhEq1atdMopp6iwsDCmDB24Yz/yyCPVsmVLnXvuuXIcJzq9W7du+u6772LWkZqaGvPJopYtW+q8887TZ599JklaunSpysrKNGzYsJgjInl5eXr00Ue1ZcsWtWvXTpLUpUuXmCIkuZ+oeuyxx/Tcc8+pqKhI+/bti773/fffq2PHjg3aRpX69OkTU4Qkd/vddNNNkhTNffzxx6t9+/YqLCyssQydffbZWrVq1UHXedRRR9X6/oHbvtKBpylrcuuttyoUCkVfDx48WN27d9eUKVP02muvHXT5VadXfV2Z4cDpyVgWADRFlKEE27Ztm2bOnKmZM2fGvVf1Y8pV/4s9PT292mllZWVxy6k8alKpbdu2KiwsjGaQpK5du1ab8ZtvvomWocrvB5o6daomTJigf/u3f1O/fv3UsmVLLVu2TL/+9a/jsjRE1XWXl5dr165dmjp1qqZOnVpt7pqEQqHoEZjaVN1uB6rpCNCuXbvifi8H07x5c1100UVaunRpvZZf9ajNgWMkxYxr6LIqj4Il8ucGAD+iDCVY69at1adPH91zzz1x71V3CuZQ7Ny5U5FIJGbHvnXrVrVv3z6aQZLmz5+v9PR0NWvWLGb+A48EVfdf/rNnz9Y111wTPYUnSX/84x/rlK3yQur9+/dH8xljtHv37rixVdedmpqqzMxMXX311TFH0Cq1bdu2xvUm4jRZ9+7dVVZWpr/97W8x9waq6ZqaujjwZ+zevbtmz54dN2bdunUaNWqUJOnYY49VSkqK1q1bp969e8eMSUtLixbcRCyrc+fOdV4WADRllKEEy8vL07x585Sbm6v09PRGWUd5ebneeeed6DVDu3fv1uLFizV27FhJUr9+/ZSenq7i4mJdeumlMadv6mLv3r3KyMiImfbyyy/HvK782aoeKao8hbZ27drodUcff/xxnY8o5eXlad26dTrjjDPqlTkRp8kGDBigYDCo2bNnRy8WD4fDeu+996Lbtq5++OEHzZ8/P+YmnIMGDdKjjz6qwsLC6M/3ySefaPPmzdEiFwqF1K9fP82ePVsjR46Mzvv666/rnHPOUTAYTMqyAKApowwl2N13363XXntNeXl5uuWWW9S+fXsVFxdryZIlOv/88/XP//zPDV5HKBTSHXfcoZ07d6pt27aaMmWKUlJS9Mtf/lKS1KZNG917770aM2aM/vznPysvL0+RSER/+ctf9Omnn2rWrFm1Lv+CCy7Qc889p9NPP12dOnXSzJkz9e2338aM6dy5s9LT0zV9+nRlZGQoIyNDp59+uvr166e2bdvqlltu0cSJE7V161Y99thjcUenavLQQw+pT58+uuSSSzRq1Ci1bt1a3377rT744AONGTNGZ599drXzZWZm1rtAVdW8eXPdeeedmjRpkkKhkLp27apHHnlEGRkZGjNmTHTcM888o5tvvlnfffed2rVrpy1btujnP/+5rr32WnXt2lVbtmzRb3/7W23fvl3jxo2Lzjdw4ECdc845uvrqq/XII4+ooqJCd911l/Ly8tSvX7/ouAkTJujCCy/UXXfdpSFDhujtt9/Whx9+qMWLFyd1WQDQZFV386HG/mrqN138+uuvzYgRI0ybNm1MRkaGycnJMddee61Zt26dMcaYtWvXGklmwYIFMfO1a9fO3HvvvTHTrrjiipib+d1zzz2mQ4cOZtGiReakk04y6enp5tRTTzXLli2Ly/H888+b3Nxck5GRYVq1amX69Olj/vM//7PGZVfavXu3GT58uGnZsqVp3bq1uemmm8wbb7xhJJkNGzbELL9r164mLS3NZGRkRKcvW7bMnHbaaeaII44wPXv2NCtXroz72Xr37m2uueaaarffypUrzaWXXmpatmxpAoGA6datmxkzZozZvHlzteMTqby83EycONG0b9/eBAIBc84555gvvvgiZszTTz9tJJnvv//eGOP+bQwZMsR06NDBpKenmxYtWpjBgwebwsLCuOVv377dXHPNNSYzM9NkZmaaESNGmB07dsSNmzVrlunRo4dJT083PXr0MHPmzEn4sg78m67rsg4HfrzZG5m948fc3HTRO6rhpouOqcMnZRItNzfXrFmzxvP1NkQ4HK736abGMG7cOL300ktxR2pqcrjkrg8ye8OPmSV/5iazd/yYu6ioKO7+Zoc7P25nSXIc53NjTNxpBG66CAAArEYZAgAAVqMM+cyUKVPqfIoMAAAcHGUIAABYjTJUD5MmTZLjONV+vfTSS8mO5xvbt2/XTTfdpKysLB1xxBHq3r27XnjhhVrnmT17ti655BJ16NBBzZs3V8+ePfXqq69WO/bZZ5/Vscceq0AgoJ49e2rRokWN8WMAAJoI7jNUTy1atND7778fN71bt25JSOM/e/bs0YABA9S8eXM9+eSTOuqoo/R///d/2r9/f63zPf744+rcubP+4z/+Q0cddZTee+89XX311dq2bZtuvfXW6LjXXntN//qv/6pJkyapX79+mj59uoYOHapVq1ZFHy4LAMCBKEP1lJaWdshPaU+EvXv36ogjjkja+hvq4Ycf1r59+1RYWBj9OQYOHHjQ+QoKCmLuHn3eeedp8+bNevzxx2PK0MSJEzVy5Ejdf//9kqRzzjlHq1ev1pQpUzh6BwCoFqfJEqyoqEiO42jWrFm66aab1KJFC3Xs2FETJ05URUVFzNgvv/xSQ4YMUSgUUigU0rBhw1RcXBx9f8mSJXIcRx988IEuueQSNW/ePHqX6Z07d+rKK69Us2bNdPTRR2vq1Km68847o/eq2LFjhwKBQNxjNIwx6ty5s+64447G3RA1mD59ukaPHl3vQlfdYzROO+00bd26Nfr6r3/9q9avX69f/OIX0WkpKSkaNmyY5s2bd+ihAQBNGmXoEEQikbivqu6++241b95cc+bM0fDhw/Xggw9qzpw50fc3btyovn37qqysTC+++KJmzJihP//5z8rPz1fVG2GOHj1ap5xyit55553oA0xHjRqlBQsW6He/+52eeeYZzZ8/X6+//np0ntatW+uyyy6LK0NLlixRUVGRrrvuuhp/voqKimp/xgO/ysvL673dNm3apK1bt6ply5YaPHiw0tPT1aZNG91xxx0HPU1WnU8//VQnnHBC9PW6deskKe6hqj169NCOHTv097//vd7rAABYoLrbUjf2l18fxzFx4kQjqdqvytupb9q0yUgyI0aMiJn/lFNOMVdccUX09fDhw81xxx1n9u3bF522fv16k5KSYt59911jjDEffvihkWR+9atfxSzriy++MJLMrFmzotNKS0vNkUceaTp16hSdtmDBAuM4jvnqq6+i00aMGGF69uxZ689a289Z+XXgeurq008/NZJM8+bNzfXXX28WLVpkHn/8cRMIBMxdd90VHVeX27wvXLjQOI4T80iUl156yUgyO3fujBm7YMECI8n85S9/qXfmuvLjren9mNkYf+Yms3f8mJvHcXhHNTyOg2uG6qlFixZauHBh3PSjjz465vWFF14Y8/qEE07Q119/HX29cOFCjRw5UikpKdEjS507d1ZOTo4KCws1ZMiQ6NgD/y1JhYWFkqT8/PzotCOOOELnn3++VqxYEZ2Wl5en7OxszZw5Uw888IDC4bDefPNNTZ06tdaf8cYbb9TQoUNrHVP1qfZVVT1alpaWFj1NeOKJJ+rZZ5+V5F77Ew6H9fDDD2vSpEnRJ6nXpqioSFdffbX+6Z/+SaNGjYp733GcmNfmxyNtVacDACBxAXW9paWl1enp6C1btox5nZ6errKysujrbdu2aerUqdUWk2+++Sbmdbt27WJeFxcXKxQKKRAIxExv06ZNzGvHcXTNNddo5syZmjRpkmbNmqVIJKKrr7661uxZWVlq27ZtrWMOVix+9rOfxbw2xqh169aS4i+YPu+88zRx4kR99dVXOvnkk2td7o4dOzRo0CBlZ2fHXRDdqlUrSdKuXbvUokWL6PRdu3ZJiv+dAAAgUYaSpvKanuuvvz7uvaoXC1ctHllZWQqHwyorK4spRNVdEzN8+HBNmTJFH374oWbMmKFLL700Whpq8uCDD+qBBx6odUynTp1UVFRU4/urVq2Km9a1a1elp6fHTa88cpOSUvslbKWlpRo6dKj279+vuXPnqlmzZjHvV14rtG7dOnXq1Ck6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\n",
      "text/plain": [
       "<Figure size 720x720 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "enes = [energy_func(*qs) for qs in results]\n",
    "best = np.argmin(enes)\n",
    "\n",
    "make_viz(tra[best], prot_seq, schedule=sched, movie=True, energy_func=energy_func)\n",
    "all_best = np.array(enes) == min(enes)\n",
    "(all_best).sum()\n",
    "plt.plot(np.sort(enes))\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "rnd_best = np.random.choice(np.argwhere(all_best).reshape((-1,)))\n",
    "print(rnd_best)\n",
    "plt.plot(energy[rnd_best])\n",
    "plt.ylim(min(enes)-5, 200)\n",
    "plt.show()\n",
    "show_video()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "def preprocess_expr(H):\n",
    "    # Helper function to clean resulting expressions\n",
    "    # some zero coefficients fail to evaluate to 0, rounding is necessary\n",
    "    # for all qbits, qi**n = qi. bc qi in [0,1]\n",
    "    H = expand(H).evalf()\n",
    "    tmp = H\n",
    "    for a in preorder_traversal(tmp):\n",
    "        if isinstance(a, Float):\n",
    "            H = H.subs(a, round(a, 8))\n",
    "    degr = Poly(H).degree()\n",
    "    for qi in q:\n",
    "        for n in reversed(range(2, degr + 1)):\n",
    "            H = H.subs(qi**n, qi)\n",
    "    return H\n",
    "energy_expr = preprocess_expr(energy_expr)\n",
    "energy_expr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
